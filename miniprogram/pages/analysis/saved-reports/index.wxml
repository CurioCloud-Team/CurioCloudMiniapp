<view class="page">
  <!-- 装饰背景 -->
  <view class="bg-decoration">
    <view class="orb orb-1"></view>
    <view class="orb orb-2"></view>
    <view class="orb orb-3"></view>
  </view>

  <!-- TDesign 导航栏 -->
  <t-navbar 
    title="历史报告" 
    fixed="{{true}}" 
    left-arrow 
    bind:go-back="backToEntry"
    class="custom-navbar" 
  />

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-state">
    <t-loading theme="circular" size="80rpx" text="加载中..." />
  </view>

  <!-- 报告列表 -->
  <view wx:elif="{{reports.length}}" class="content-area">
    <!-- 统计卡片 -->
    <view class="stats-banner">
      <view class="stats-item">
        <text class="stats-value">{{reports.length}}</text>
        <text class="stats-label">历史报告</text>
      </view>
    </view>

    <!-- 报告列表 -->
    <view class="report-list">
      <block wx:for="{{reports}}" wx:key="id">
        <view class="report-card" bindtap="openReport" data-id="{{item.id}}">
          <view class="card-icon">
            <t-icon name="chart-pie" size="44rpx" color="#667eea" />
          </view>
          <view class="card-content">
            <view class="card-header">
              <text class="card-title">{{item.title || '分析报告'}}</text>
              <view class="card-arrow">
                <t-icon name="chevron-right" size="40rpx" color="#94a3b8" />
              </view>
            </view>
            <view class="card-meta">
              <view class="meta-tag">
                <t-icon name="time" size="24rpx" color="#64748b" />
                <text>{{item.date}}</text>
              </view>
              <view class="meta-tag">
                <t-icon name="user" size="24rpx" color="#64748b" />
                <text>{{item.student_count}} 人</text>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 底部提示 -->
    <view class="list-footer">
      <text>下拉刷新加载更多</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view wx:else class="empty-state">
    <view class="empty-icon">
      <t-icon name="file-unknown" size="120rpx" color="#cbd5e1" />
    </view>
    <text class="empty-title">暂无历史报告</text>
    <text class="empty-desc">上传学生成绩后将在这里显示分析报告</text>
    <t-button 
      theme="primary" 
      size="large" 
      bindtap="backToEntry"
      class="empty-btn"
    >
      <t-icon name="add" size="36rpx" />
      开始上传
    </t-button>
  </view>
</view>
