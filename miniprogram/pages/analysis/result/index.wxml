<view class="page">
  <view wx:if="{{loading}}" class="loading">加载中...</view>

  <view wx:elif="{{report}}">
    <view class="card">
      <text class="title">{{report.title}}</text>
      <text class="subtitle">生成时间：{{report.created_at}}</text>
      <text class="meta">覆盖学生：{{report.student_count}} 人</text>
    </view>

    <view class="card">
      <text class="section-title">成绩概览</text>
      <view class="summary-grid">
        <view class="summary-item">
          <text class="label">平均分</text>
          <text class="value">{{report.summary.average_score}}</text>
        </view>
        <view class="summary-item">
          <text class="label">最高分</text>
          <text class="value">{{report.summary.highest_score}}</text>
        </view>
        <view class="summary-item">
          <text class="label">最低分</text>
          <text class="value">{{report.summary.lowest_score}}</text>
        </view>
        <view class="summary-item">
          <text class="label">及格率</text>
          <text class="value">{{report.summary.pass_rate}}%</text>
        </view>
      </view>
      <view class="distribution">
        <text class="distribution-title">分数段分布</text>
        <block wx:for="{{report.summary.distribution}}" wx:key="range">
          <view class="distribution-row">
            <text>{{item.range}}</text>
            <text>{{item.count}} 人</text>
          </view>
        </block>
      </view>
    </view>

    <view class="card">
      <text class="section-title">洞察</text>
      <block wx:for="{{report.insights}}" wx:key="title">
        <view class="insight">
          <text class="insight-title">{{item.title}}</text>
          <text class="insight-desc">{{item.description}}</text>
          <view class="suggestions">
            <text class="suggestion-label">建议：</text>
            <block wx:for="{{item.suggestions}}" wx:key="index">
              <text class="suggestion-chip">{{suggestion}}</text>
            </block>
          </view>
        </view>
      </block>
    </view>

    <view class="card">
      <text class="section-title">推荐行动</text>
      <block wx:for="{{report.recommended_actions}}" wx:key="index">
        <view class="action-item">• {{item}}</view>
      </block>
    </view>

    <button class="primary" bindtap="goBack">返回上一页</button>
  </view>

  <view wx:else class="empty">暂无报告数据</view>
</view>
